<!--
 * ============================================
 * AGENDA TELEFÔNICA - Interface Principal
 * ============================================
 * 
 * PROPÓSITO:
 * Esta é a camada de apresentação da aplicação. Define toda a estrutura
 * visual e semântica da interface do usuário.
 * 
 * Responsabilidades:
 * - Fornecer interface amigável para usuários interagirem com a agenda
 * - Estruturar semanticamente o conteúdo (acessibilidade e SEO)
 * - Separar apresentação (HTML) de estilo (CSS) e comportamento (JS)
 * - SPA (Single Page Application) - sem recarregamentos de página
 * 
 * ARQUITETURA:
 * 1. HEAD: Meta tags, títulos, links para CSS e fonts
 * 2. HEADER: Cabeçalho com título e identidade visual
 * 3. MAIN: Conteúdo principal dividido em 2 seções:
 *    - Formulário de Cadastro (criar/editar contatos)
 *    - Lista de Contatos (visualizar, editar, excluir)
 * 4. FOOTER: Informações de rodapé e botão de exportação
 * 5. MODALS: Diálogos para confirmações e avisos (duplicatas)
 * 6. SCRIPTS: JavaScript para interatividade
 * 
 * DESIGN SYSTEM:
 * - Dark Mode permanente (sem toggle)
 * - Paleta: Slate (backgrounds), Blue (primário), Green/Red (ações)
 * - Tipografia: Inter (Google Fonts)
 * - Ícones: Lucide (CDN)
 * - Framework CSS: Tailwind v4
 * 
 * RESPONSIVIDADE:
 * - Mobile first approach
 * - Grid adaptativo (1 col mobile → 2 cols desktop)
 * - Touch-friendly (botões grandes, espaçamento generoso)
-->
<!DOCTYPE html>
<html lang="pt-BR" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Sistema de gerenciamento de agenda telefônica - Cadastre, pesquise e gerencie contatos com facilidade">
    <meta name="author" content="Teste Prático - Agenda Telefônica">
    <title>Agenda Telefônica | Gerenciador de Contatos</title>

    <!-- CSS Compilado do Tailwind -->
    <link rel="stylesheet" href="output.css">

    <!-- Ícones Lucide via CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/favico.ico">
</head>

<body class="gradient-bg min-h-screen font-sans antialiased">
    <!-- ============================================
         OVERLAY DE CARREGAMENTO
         ============================================
         Exibido durante operações assíncronas (salvar, deletar, carregar)
         Previne interações enquanto aguarda resposta do servidor
    -->
    <div id="loading"
        class="hidden fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="animate-spin rounded-full h-16 w-16 border-4 border-blue-500 border-t-transparent mx-auto mb-4">
            </div>
            <p class="text-white text-lg font-medium">Processando...</p>
        </div>
    </div>

    <!-- ============================================
         HEADER - Cabeçalho da Aplicação
         ============================================
         Identidade visual, título e contexto da aplicação
    -->
    <header class="gradient-primary shadow-2xl sticky top-0 z-40 backdrop-blur-sm">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex items-center justify-center space-x-3">
                <div class="bg-white/10 p-3 rounded-xl backdrop-blur-sm">
                    <i data-lucide="phone" class="w-8 h-8 text-white"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-bold text-white tracking-tight">
                        Agenda Telefônica
                    </h1>
                    <p class="text-blue-100 text-sm">Sistema de gerenciamento de contatos</p>
                </div>
            </div>
        </div>
    </header>

    <!-- ============================================
         MAIN - Conteúdo Principal
         ============================================
         Dividido em duas seções principais: Cadastro e Listagem
    -->
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 max-w-7xl">
        <!-- Use a single main column; internal sections will adapt responsively -->
        <div class="grid grid-cols-1 gap-8">

            <!-- ============================================
                 SEÇÃO 1: FORMULÁRIO DE CADASTRO
                 ============================================
                 Permite criar novos contatos ou editar existentes
                 Validações: nome obrigatório, idade numérica, telefones 10-11 dígitos
            -->
            

            <!-- ============================================
                 SEÇÃO 2: PESQUISA E LISTAGEM DE CONTATOS
                 ============================================
                 Busca por nome ou telefone + exibição em cards expansíveis
            -->
            <section class="space-y-6">
                <!-- Barra de Pesquisa -->
                <div class="bg-slate-800/80 backdrop-blur-sm rounded-2xl shadow-2xl p-6 border border-slate-700">
                    <!-- Cabeçalho: título à esquerda e Novo Contato à direita -->
                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center justify-between mb-4 gap-3">
                        <div class="flex items-center space-x-3">
                            <div class="bg-gradient-to-br from-blue-500 to-blue-700 p-2.5 rounded-lg">
                                <i data-lucide="search" class="w-6 h-6 text-white"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-white">Pesquisar Contatos</h2>
                        </div>
                        <button onclick="mostrarFormulario()"
                            class="w-full sm:w-auto gradient-primary text-white px-6 py-3 rounded-lg font-medium hover:opacity-90 transition-all flex items-center justify-center gap-2">
                            <i data-lucide="user-plus" class="w-5 h-5"></i>
                            <span>Novo Contato</span>
                        </button>
                    </div>

                    <!-- Linha abaixo: campo de busca e botão Limpar -->
                    <div class="flex flex-col sm:flex-row gap-2 items-stretch" role="search" aria-label="Pesquisar contatos">
                        <div class="relative flex-1 min-w-0">
                            <i data-lucide="search" aria-hidden="true" class="w-5 h-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none"></i>
                            <input type="text" id="termoPesquisa" placeholder="Digite nome ou telefone..." aria-label="Pesquisar contatos por nome ou telefone" inputmode="search" enterkeyhint="search" autocomplete="off"
                                class="w-full pl-10 pr-4 py-4 sm:py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-base sm:text-sm">
                        </div>
                        <button onclick="document.getElementById('termoPesquisa').value=''; carregarContatos()"
                            class="w-full sm:w-auto bg-slate-700 hover:bg-slate-600 text-slate-300 px-6 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2">
                            <i data-lucide="x" class="w-5 h-5"></i>
                            <span class="hidden sm:inline">Limpar</span>
                        </button>
                    </div>
                </div>

                <!-- Lista de Contatos -->
                <div class="bg-slate-800/80 backdrop-blur-sm rounded-2xl shadow-2xl p-6 border border-slate-700">
                    <div class="flex items-center space-x-3 mb-6">
                        <div class="bg-gradient-to-br from-blue-500 to-blue-700 p-2.5 rounded-lg">
                            <i data-lucide="users" class="w-6 h-6 text-white"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-white">Meus Contatos</h2>
                    </div>

                <!-- Grid de Cards (preenchido dinamicamente via JavaScript)
                    Responsivo: 1 coluna (mobile), 2 (tablet), 3 (desktop) -->
                <div id="listaContatos" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Cards serão inseridos aqui via JavaScript -->
                        <div class="text-center py-12">
                            <i data-lucide="loader" class="w-16 h-16 mx-auto mb-4 text-slate-600 animate-spin"></i>
                            <p class="text-slate-400 text-lg">Carregando contatos...</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- ============================================
         FOOTER - Rodapé
         ============================================
         Informações do sistema e ação de exportar banco de dados
    -->
    <footer class="bg-slate-900/50 backdrop-blur-sm border-t border-slate-800 py-6 mt-12">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                <p class="text-slate-400 text-sm flex items-center gap-2">
                    <i data-lucide="code" class="w-4 h-4"></i>
                    Desenvolvido com Node.js, SQLite e Tailwind CSS.
                </p>
                <button onclick="abrirModalExportar()"
                    class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-lg font-medium transition-colors flex items-center gap-2 shadow-lg">
                    <i data-lucide="download" class="w-4 h-4"></i>
                    <span>Exportar Dados</span>
                </button>
            </div>
        </div>
    </footer>

        <!-- ============================================
             MODAL: FORMULÁRIO DE CONTATO (FULLSCREEN OVERLAY)
             ============================================ -->
        <div id="modalForm" class="hidden fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
            <div id="formCadastro" class="bg-slate-800/90 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-slate-700 animate-fade-in">
                <div class="p-6 sm:p-8">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center space-x-3">
                            <div class="bg-gradient-to-br from-blue-500 to-blue-700 p-2.5 rounded-lg">
                                <i data-lucide="user-plus" class="w-6 h-6 text-white"></i>
                            </div>
                            <h2 id="tituloFormulario" class="text-2xl font-bold text-white">Novo Contato</h2>
                        </div>
                        <button type="button" onclick="fecharModalForm()" class="text-slate-300 hover:text-white p-2 rounded-lg hover:bg-slate-700 transition-colors" aria-label="Fechar">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>

                    <form id="formContato" onsubmit="event.preventDefault(); salvarContato();" class="space-y-5">
                        <input type="hidden" id="contatoIdHidden" value="">
                        <!-- Campo: Nome -->
                        <div>
                            <label for="nome" class="block text-sm font-medium text-slate-300 mb-2 flex items-center gap-2">
                                <i data-lucide="user" class="w-4 h-4"></i>
                                Nome Completo
                            </label>
                            <input type="text" id="nome" required placeholder="Ex: João Silva"
                                class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>

                        <!-- Campo: Idade -->
                        <div>
                            <label for="idade" class="block text-sm font-medium text-slate-300 mb-2 flex items-center gap-2">
                                <i data-lucide="calendar" class="w-4 h-4"></i>
                                Idade (opcional)
                            </label>
                            <input type="number" id="idade" min="1" max="150" placeholder="Ex: 25"
                                class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>

                        <!-- Campo: Telefones -->
                        <div>
                            <label for="telefones" class="block text-sm font-medium text-slate-300 mb-2 flex items-center gap-2">
                                <i data-lucide="phone" class="w-4 h-4"></i>
                                Telefones
                            </label>
                            <textarea id="telefones" required rows="4"
                                placeholder="Digite um ou mais telefones (um por linha)&#10;Ex: (11) 98765-4321&#10;     (11) 3456-7890"
                                class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none"></textarea>
                            <p class="mt-2 text-xs text-slate-400">
                                <i data-lucide="info" class="w-3 h-3 inline"></i>
                                Telefones devem ter 10 ou 11 dígitos. Separe múltiplos números por linha.
                            </p>
                        </div>

                        <!-- Botões de Ação -->
                        <div class="flex gap-3 pt-4">
                            <button type="submit" id="btnSalvar"
                                class="flex-1 gradient-primary text-white px-6 py-3 rounded-lg font-medium hover:opacity-90 transition-all flex items-center justify-center gap-2 shadow-lg">
                                <i data-lucide="save" class="w-5 h-5"></i>
                                <span>Salvar Contato</span>
                            </button>
                            <button type="button" onclick="cancelarEdicao()"
                                class="bg-slate-700 hover:bg-slate-600 text-slate-300 px-6 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2">
                                <i data-lucide="x" class="w-5 h-5"></i>
                                <span>Cancelar</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    <!-- ============================================
         MODAL: EXPORTAR DADOS
         ============================================ -->
    <div id="modalExportar" class="hidden fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl shadow-2xl max-w-md w-full p-6 border border-slate-700 animate-fade-in">
            <div class="flex items-center gap-3 mb-4">
                <div class="bg-blue-500/20 p-3 rounded-lg">
                    <i data-lucide="download" class="w-6 h-6 text-blue-400"></i>
                </div>
                <h3 class="text-xl font-bold text-white">Exportar Dados</h3>
            </div>
            <p class="text-slate-300 mb-4">Escolha o formato desejado para baixar seus contatos.</p>
            <div class="grid grid-cols-2 gap-3 mb-4">
                <button onclick="exportarFormato('csv')" class="bg-slate-700 hover:bg-slate-600 text-slate-200 px-4 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 border border-slate-700">
                    <i data-lucide="file-spreadsheet" class="w-4 h-4"></i>
                    <span>CSV</span>
                </button>
                <button onclick="exportarFormato('txt')" class="bg-slate-700 hover:bg-slate-600 text-slate-200 px-4 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 border border-slate-700">
                    <i data-lucide="file-text" class="w-4 h-4"></i>
                    <span>TXT</span>
                </button>
                <button onclick="exportarFormato('json')" class="bg-slate-700 hover:bg-slate-600 text-slate-200 px-4 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 border border-slate-700">
                    <i data-lucide="braces" class="w-4 h-4"></i>
                    <span>JSON</span>
                </button>
                <button onclick="exportarFormato('sqlite')" class="bg-slate-700 hover:bg-slate-600 text-slate-200 px-4 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 border border-slate-700">
                    <i data-lucide="database" class="w-4 h-4"></i>
                    <span>SQLite</span>
                </button>
            </div>
            <div class="flex gap-3">
                <button onclick="fecharModalExportar()" class="flex-1 bg-slate-700 hover:bg-slate-600 text-slate-300 px-4 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2">
                    <i data-lucide="x" class="w-4 h-4"></i>
                    <span>Cancelar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL: TELEFONE DUPLICADO
         ============================================
         Exibido quando usuário tenta cadastrar telefone já existente
         Oferece opção de editar contato existente ou cancelar
    -->
    <div id="modalDuplicata"
        class="hidden fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl shadow-2xl max-w-md w-full p-6 border border-slate-700 animate-fade-in">
            <div class="flex items-center gap-3 mb-4">
                <div class="bg-yellow-500/20 p-3 rounded-lg">
                    <i data-lucide="alert-triangle" class="w-6 h-6 text-yellow-500"></i>
                </div>
                <h3 class="text-xl font-bold text-white">Telefone Já Cadastrado</h3>
            </div>

            <p class="text-slate-300 mb-4">
                Este número de telefone já está registrado para o seguinte contato:
            </p>

            <!-- Informações do contato existente (preenchido dinamicamente) -->
            <div id="infoContatoDuplicata" class="bg-slate-900/50 rounded-lg p-4 mb-6 border border-slate-700">
                <!-- Preenchido via JavaScript -->
            </div>

            <div class="flex gap-3">
                <button id="btnEditarExistente"
                    class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2">
                    <i data-lucide="edit" class="w-4 h-4"></i>
                    <span>Editar Contato</span>
                </button>
                <button onclick="fecharModalDuplicata()"
                    class="flex-1 bg-slate-700 hover:bg-slate-600 text-slate-300 px-4 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2">
                    <i data-lucide="x" class="w-4 h-4"></i>
                    <span>Cancelar</span>
                </button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>